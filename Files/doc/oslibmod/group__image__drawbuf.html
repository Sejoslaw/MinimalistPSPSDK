<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Drawbuffers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('group__image__drawbuf.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>Drawbuffers</h1>  </div>
<div class="ingroups"><a class="el" href="group__image.html">Images</a></div></div>
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#gaa993d7fcdad0db1a84e7e74456518857">oslGetDrawBuffer</a>()&#160;&#160;&#160;osl_curBuf</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#ga2147f218ba6ee7007b6df6095d69fdd3">OSL_DEFAULT_BUFFER</a>&#160;&#160;&#160;(&amp;osl_defaultBufferImage)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#gac1fd66db227dedd5ba7916f6cfc6045b">OSL_SECONDARY_BUFFER</a>&#160;&#160;&#160;(&amp;osl_secondaryBufferImage)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#gae00d04c9283976e9fe3059a148d62e25">OSL_SCREEN_WIDTH</a>&#160;&#160;&#160;(osl_curBuf-&gt;sizeX)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#ga4dd9895b0425e89e0f8ab11dc3b72348">OSL_SCREEN_HEIGHT</a>&#160;&#160;&#160;(osl_curBuf-&gt;sizeY)</td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#ga9f57a711db94dc834f61767f5108418e">OSL_FX_ALPHAWRITE</a> { <a class="el" href="group__image__drawbuf.html#gga9f57a711db94dc834f61767f5108418ea6d9b5f543777e638b572a55c753e1d26">OSL_FXAW_NONE</a>, 
<a class="el" href="group__image__drawbuf.html#gga9f57a711db94dc834f61767f5108418ea23e620a396a6a5b0998624dc9f2d5030">OSL_FXAW_SET</a>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#gadcde934a8cf8a68f754b31909a8e2e22">OSL_FX_ALPHATEST</a> </td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#gaa5d784fdfe5f2ee9b95b4f5abf7d45aa">oslSetDrawBuffer</a> (<a class="el" href="struct_o_s_l___i_m_a_g_e.html">OSL_IMAGE</a> *img)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#ga0df7d7540fc72fc9560abd76ff25b0e6">oslSetAlphaWrite</a> (int action, int value1, int value2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#gade27ffb897e7be79745772674c0ec518">oslSetAlphaTest</a> (int condition, int value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#ga1d4e8f0c72113d98cab34911ac97b0e3">oslDisableAlphaTest</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__image__drawbuf.html#gab22557392550001a2f0f3390e04fec3e">osl_alphaTestEnabled</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Drawbuffers is an advanced and powerful capability of OSLib images, it allows you to draw directly on an image exactly as if you were drawing on the screen! See <a class="el" href="group__image__drawbuf.html#gaa5d784fdfe5f2ee9b95b4f5abf7d45aa">oslSetDrawBuffer</a> for basic a code sample. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="gaa993d7fcdad0db1a84e7e74456518857"></a><!-- doxytag: member="drawing.h::oslGetDrawBuffer" ref="gaa993d7fcdad0db1a84e7e74456518857" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define oslGetDrawBuffer</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;osl_curBuf</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the current drawbuffer as an <a class="el" href="struct_o_s_l___i_m_a_g_e.html">OSL_IMAGE</a>. You can save it to restore it later. </p>

</div>
</div>
<a class="anchor" id="ga2147f218ba6ee7007b6df6095d69fdd3"></a><!-- doxytag: member="drawing.h::OSL_DEFAULT_BUFFER" ref="ga2147f218ba6ee7007b6df6095d69fdd3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSL_DEFAULT_BUFFER&#160;&#160;&#160;(&amp;osl_defaultBufferImage)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>An image representing the primary buffer image, which is the buffer to which you are currently writing (see oslSwapBuffers for more information). </p>

</div>
</div>
<a class="anchor" id="gac1fd66db227dedd5ba7916f6cfc6045b"></a><!-- doxytag: member="drawing.h::OSL_SECONDARY_BUFFER" ref="gac1fd66db227dedd5ba7916f6cfc6045b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSL_SECONDARY_BUFFER&#160;&#160;&#160;(&amp;osl_secondaryBufferImage)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>An image representing the secondary buffer image, which is the buffer currently displayed to the user (see oslSwapBuffers for more information). In single buffering mode, OSL_DEFAULT_BUFFER is identical to OSL_SECONDARY_BUFFER. </p>

</div>
</div>
<a class="anchor" id="gae00d04c9283976e9fe3059a148d62e25"></a><!-- doxytag: member="drawing.h::OSL_SCREEN_WIDTH" ref="gae00d04c9283976e9fe3059a148d62e25" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSL_SCREEN_WIDTH&#160;&#160;&#160;(osl_curBuf-&gt;sizeX)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the width of the current drawbuffer. On the default drawbuffer (i.e. the screen) it will be the resolution of the PSP LCD, that is 480 pixels. By taking these values in account you can make game that automatically adapt to another resolution. </p>

</div>
</div>
<a class="anchor" id="ga4dd9895b0425e89e0f8ab11dc3b72348"></a><!-- doxytag: member="drawing.h::OSL_SCREEN_HEIGHT" ref="ga4dd9895b0425e89e0f8ab11dc3b72348" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSL_SCREEN_HEIGHT&#160;&#160;&#160;(osl_curBuf-&gt;sizeY)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the height of the current drawbuffer. On the default drawbuffer (i.e. the screen) it will be the resolution of the PSP LCD, that is 272 pixels. </p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ga9f57a711db94dc834f61767f5108418e"></a><!-- doxytag: member="drawing.h::OSL_FX_ALPHAWRITE" ref="ga9f57a711db94dc834f61767f5108418e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__image__drawbuf.html#ga9f57a711db94dc834f61767f5108418e">OSL_FX_ALPHAWRITE</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Available effects for <a class="el" href="group__image__drawbuf.html#ga0df7d7540fc72fc9560abd76ff25b0e6">oslSetAlphaWrite</a>. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga9f57a711db94dc834f61767f5108418ea6d9b5f543777e638b572a55c753e1d26"></a><!-- doxytag: member="OSL_FXAW_NONE" ref="gga9f57a711db94dc834f61767f5108418ea6d9b5f543777e638b572a55c753e1d26" args="" -->OSL_FXAW_NONE</em>&nbsp;</td><td>
<p>Does not write alpha. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga9f57a711db94dc834f61767f5108418ea23e620a396a6a5b0998624dc9f2d5030"></a><!-- doxytag: member="OSL_FXAW_SET" ref="gga9f57a711db94dc834f61767f5108418ea23e620a396a6a5b0998624dc9f2d5030" args="" -->OSL_FXAW_SET</em>&nbsp;</td><td>
<p>Sets alpha to value1 if the alpha channel of the pixel is not equal to value2. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gadcde934a8cf8a68f754b31909a8e2e22"></a><!-- doxytag: member="drawing.h::OSL_FX_ALPHATEST" ref="gadcde934a8cf8a68f754b31909a8e2e22" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__image__drawbuf.html#gadcde934a8cf8a68f754b31909a8e2e22">OSL_FX_ALPHATEST</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Alpha test comparision operators. See <a class="el" href="group__image__drawbuf.html#gade27ffb897e7be79745772674c0ec518">oslSetAlphaTest</a>. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gaa5d784fdfe5f2ee9b95b4f5abf7d45aa"></a><!-- doxytag: member="drawing.h::oslSetDrawBuffer" ref="gaa5d784fdfe5f2ee9b95b4f5abf7d45aa" args="(OSL_IMAGE *img)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oslSetDrawBuffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_o_s_l___i_m_a_g_e.html">OSL_IMAGE</a> *&#160;</td>
          <td class="paramname"><em>img</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Define an image as the current drawbuffer. Don't forget to restore the original drawbuffer once you've finished drawing to the image. Here is an example that draws something on an image, and then draws that image on the real screen. </p>
<div class="fragment"><pre class="fragment"><a class="code" href="struct_o_s_l___i_m_a_g_e.html">OSL_IMAGE</a> *drawBuf = <a class="code" href="group__image__creation.html#ga120ad0461bc8369f9431bff653d25217">oslCreateImage</a>(320, 182, <a class="code" href="group__image.html#gga163a37d9c3999633b0dc387e15453845a577e8c8ab69f9bfe0eea6d7e1ce3aa62" title="In VRAM.">OSL_IN_VRAM</a>, <a class="code" href="group__image.html#ggab3528cc93235f479e65017b9cc0a2259a39ff6e7064d85cc43689fc4d544e6dc3" title="16 bits, 5 bits per component, except green which has 6, no alpha">OSL_PF_5650</a>);
<span class="comment">//Clear the image to black</span>
<a class="code" href="group__image__manip.html#gaa75c6d305e26d263e55bcdc1729532a7">oslClearImage</a>(drawBuf, <a class="code" href="group__drawing__color.html#ga23a5c1aba49a36105f9c574d630a05b9">RGB16</a>(0, 0, 0));
<span class="comment">//We set that image as the drawbuffer</span>
<a class="code" href="group__image__drawbuf.html#gaa5d784fdfe5f2ee9b95b4f5abf7d45aa">oslSetDrawBuffer</a>(drawBuf);
<span class="comment">//Draw a red filled rectangle on the image</span>
<a class="code" href="group__drawing__shapes.html#ga050574332d7045466f92a0db0f6ba0af">oslDrawFillRect</a>(0, 0, 100, 100, <a class="code" href="group__drawing__color.html#ga40633ebf1f71d424dd0450542316ad9a">RGB</a>(255, 0, 0));
<span class="comment">//Restore the default drawbuffer</span>
<a class="code" href="group__image__drawbuf.html#gaa5d784fdfe5f2ee9b95b4f5abf7d45aa">oslSetDrawBuffer</a>(<a class="code" href="group__image__drawbuf.html#ga2147f218ba6ee7007b6df6095d69fdd3">OSL_DEFAULT_BUFFER</a>);
<span class="comment">//Draw that image somewhere on the screen</span>
<a class="code" href="group__image__drawing.html#ga0d0f05ee1a7f2d97edf735b4e668aec2">oslDrawImageXY</a>(drawBuf, 80, 45);
</pre></div><p><b>Important:</b> The image pixel format must be non-paletted! (supported formats are 4444, 5551, 5650 and 8888). 8888 mode (32-bit) is slower than others and the image is bigger. Also, the image MUST be in video memory (OSL_IN_VRAM). The GPU can't write to regular RAM (it can only read from it).</p>
<p>A common problem is the image not being displayed because its alpha is null. You can temporarily disable alpha blending by calling oslSetAlpha(OSL_FX_NONE, 0) to prevent this problem, but the best solution is to not forget to always clear the image after you've created it! </p>

</div>
</div>
<a class="anchor" id="ga0df7d7540fc72fc9560abd76ff25b0e6"></a><!-- doxytag: member="drawing.h::oslSetAlphaWrite" ref="ga0df7d7540fc72fc9560abd76ff25b0e6" args="(int action, int value1, int value2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oslSetAlphaWrite </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Enables writing to the alpha channel of the drawbuffer. You won't care about it when using the standard drawbuffer, but when it comes to draw on an image, it may become important. By default, alpha values are never set on the drawbuffer (let as they are). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td><ul>
<li>OSL_FXAW_SET: Set the alpha to value1. Every pixel written to the drawbuffer will set the alpha value to value1. All pixels (for example from a square or rectangle image) will set the alpha value, even if they are transparent. In order to avoid this, you can set-up an alpha test which masks out transparents pixels. They will not be drawn and the alpha value will not be written in the drawbuffer. </li>
</ul>
</td></tr>
    <tr><td class="paramname">value1</td><td>If action is OSL_FXAW_SET, this parameter holds the alpha opacity to be written, from 0 to 255 (0 = transparent, 255 = opaque). </td></tr>
    <tr><td class="paramname">value2</td><td>Not used, let it 0.</td></tr>
  </table>
  </dd>
</dl>
<p>I've not got pure copy of the alpha values to work. If someone has already used it and wants to share his experience, it would be very nice.</p>
<div class="fragment"><pre class="fragment"><span class="comment">//Clear image to transparent (alpha=0)</span>
<a class="code" href="group__image__manip.html#gaa75c6d305e26d263e55bcdc1729532a7">oslClearImage</a>(buffer, <a class="code" href="group__drawing__color.html#gabef0f315b5b7260110139f4582fb03bb">RGBA</a>(0, 0, 0, 0));
<span class="comment">//Set it as drawbuffer</span>
<a class="code" href="group__image__drawbuf.html#gaa5d784fdfe5f2ee9b95b4f5abf7d45aa">oslSetDrawBuffer</a>(buffer);
<span class="comment">//Every pixel written will take the value 255 (opaque)</span>
<a class="code" href="group__image__drawbuf.html#ga0df7d7540fc72fc9560abd76ff25b0e6">oslSetAlphaWrite</a>(<a class="code" href="group__image__drawbuf.html#gga9f57a711db94dc834f61767f5108418ea23e620a396a6a5b0998624dc9f2d5030" title="Sets alpha to value1 if the alpha channel of the pixel is not equal to value2.">OSL_FXAW_SET</a>, 255, 0);
<span class="comment">//But do not draw transparent pixels (only those greater than 0).</span>
<a class="code" href="group__image__drawbuf.html#gade27ffb897e7be79745772674c0ec518">oslSetAlphaTest</a>(OSL_FXAT_GREATER, 0);
[...]
</pre></div> 
</div>
</div>
<a class="anchor" id="gade27ffb897e7be79745772674c0ec518"></a><!-- doxytag: member="drawing.h::oslSetAlphaTest" ref="gade27ffb897e7be79745772674c0ec518" args="(int condition, int value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oslSetAlphaTest </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>condition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set alpha testing parameters. The test will be made against the alpha value of the pixel to be drawn. If the test passes, the pixel is written to the screen, else it is ignored. Note that pixels from a OSL_PF_5650 image do not initially contain alpha, but obviously it is automatically set to opaque (alpha = 255). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">condition</td><td>Condition for the test to pass. Can be one of the following:</p>
<ul>
<li>OSL_FXAT_NEVER: Never passes.</li>
<li>OSL_FXAT_ALWAYS: Always passes.</li>
<li>OSL_FXAT_EQUAL: Alpha is equal to value.</li>
<li>OSL_FXAT_NOTEQUAL: Alpha is not equal to value.</li>
<li>OSL_FXAT_LESS: Alpha is less than value.</li>
<li>OSL_FXAT_LEQUAL: Alpha is less or equal to value.</li>
<li>OSL_FXAT_GREATER: Alpha is greater than value.</li>
<li>OSL_FXAT_GEQUAL: Alpha is greater or equal to value. </li>
</ul>
</td></tr>
    <tr><td class="paramname">value</td><td>Reference value for comparision. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga1d4e8f0c72113d98cab34911ac97b0e3"></a><!-- doxytag: member="drawing.h::oslDisableAlphaTest" ref="ga1d4e8f0c72113d98cab34911ac97b0e3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oslDisableAlphaTest </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Disables alpha testing. </p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="gab22557392550001a2f0f3390e04fec3e"></a><!-- doxytag: member="drawing.h::osl_alphaTestEnabled" ref="gab22557392550001a2f0f3390e04fec3e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__image__drawbuf.html#gab22557392550001a2f0f3390e04fec3e">osl_alphaTestEnabled</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Holds whether alpha testing is currently enabled. </p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">Generated on Tue May 17 2011 10:54:47 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>

</body>
</html>
