<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Virtual Files</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('group__virtualfile.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#groups">Modules</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>Virtual Files</h1>  </div>
</div>
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_o_s_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">OSL_VIRTUALFILENAME</a></td></tr>
<tr><td colspan="2"><h2><a name="groups"></a>
Modules</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile__io.html">I/O routines</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile__sources.html">Virtual file sources</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile__ram.html">RAM virtual files</a></td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga2e7ccec76b09ff3f2d925f60050b5fcb">VF_OPEN_MODES</a> { <a class="el" href="group__virtualfile.html#gga2e7ccec76b09ff3f2d925f60050b5fcba2e020641b63339f59df52a0c2d4d3a02">VF_O_READ</a>, 
<a class="el" href="group__virtualfile.html#gga2e7ccec76b09ff3f2d925f60050b5fcbadf9ddacf8fe982cb181d2937fd35f4ec">VF_O_READWRITE</a>, 
<a class="el" href="group__virtualfile.html#gga2e7ccec76b09ff3f2d925f60050b5fcbab0b2f6caaeec6ee61c08f33a74c7c589">VF_O_WRITE</a>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#gaa547c677ff6bf88640719a647cd02584">VirtualFileInit</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga07077224dae9a3b273e364c1167f7908">VirtualFileOpen</a> (void *param1, int param2, int type, int mode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga22020f913566390f6578dfccefdf7219">VirtualFileClose</a> (<a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *f)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga0181b5d9f972777de7a959a47403ffb5">VirtualFileRegisterSource</a> (<a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a> *vfs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_o_s_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">OSL_VIRTUALFILENAME</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga6f7804ec2206cf7b3de11a951f82763c">oslFindFileInVirtualFilenameList</a> (const char *fname, int type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga81e5e0ef4b85e053188625c88b32c5a1">oslReadEntireFileToMemory</a> (<a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *f, int *size)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Virtual File support for OSLib. This API is meant to be an universal mean to manipulate every file source possible as you can define your own. </p>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ga2e7ccec76b09ff3f2d925f60050b5fcb"></a><!-- doxytag: member="VirtualFile.h::VF_OPEN_MODES" ref="ga2e7ccec76b09ff3f2d925f60050b5fcb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__virtualfile.html#ga2e7ccec76b09ff3f2d925f60050b5fcb">VF_OPEN_MODES</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Enumeration describing the available file open modes. Please note that some sources do not support some modes like READWRITE or WRITE, in this case they'll fail when an attempt to open a file in one of these modes is made. The resulting file returned by VirtualFileOpen will be NULL. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga2e7ccec76b09ff3f2d925f60050b5fcba2e020641b63339f59df52a0c2d4d3a02"></a><!-- doxytag: member="VF_O_READ" ref="gga2e7ccec76b09ff3f2d925f60050b5fcba2e020641b63339f59df52a0c2d4d3a02" args="" -->VF_O_READ</em>&nbsp;</td><td>
<p>Read only. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2e7ccec76b09ff3f2d925f60050b5fcbadf9ddacf8fe982cb181d2937fd35f4ec"></a><!-- doxytag: member="VF_O_READWRITE" ref="gga2e7ccec76b09ff3f2d925f60050b5fcbadf9ddacf8fe982cb181d2937fd35f4ec" args="" -->VF_O_READWRITE</em>&nbsp;</td><td>
<p>Read &amp; Write. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2e7ccec76b09ff3f2d925f60050b5fcbab0b2f6caaeec6ee61c08f33a74c7c589"></a><!-- doxytag: member="VF_O_WRITE" ref="gga2e7ccec76b09ff3f2d925f60050b5fcbab0b2f6caaeec6ee61c08f33a74c7c589" args="" -->VF_O_WRITE</em>&nbsp;</td><td>
<p>Write only. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gaa547c677ff6bf88640719a647cd02584"></a><!-- doxytag: member="VirtualFile.h::VirtualFileInit" ref="gaa547c677ff6bf88640719a647cd02584" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VirtualFileInit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initializes the virtual filesystem. Done by default by OSLib, so there is no need to call it by yourself. </p>

</div>
</div>
<a class="anchor" id="ga07077224dae9a3b273e364c1167f7908"></a><!-- doxytag: member="VirtualFile.h::VirtualFileOpen" ref="ga07077224dae9a3b273e364c1167f7908" args="(void *param1, int param2, int type, int mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a>* VirtualFileOpen </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>param1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>param2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Open a new file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">param1</td><td>Pointer to a string representing the file name. </td></tr>
    <tr><td class="paramname">type</td><td>File type. By default, can be:</p>
<ul>
<li>VF_MEMORY: read/write from a memory block</li>
<li>VF_FILE: read from standard stdio routines. </li>
</ul>
</td></tr>
    <tr><td class="paramname">mode</td><td>One of VF_OPEN_MODES. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga22020f913566390f6578dfccefdf7219"></a><!-- doxytag: member="VirtualFile.h::VirtualFileClose" ref="ga22020f913566390f6578dfccefdf7219" args="(VIRTUAL_FILE *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int VirtualFileClose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Closes an open file. </p>

</div>
</div>
<a class="anchor" id="ga0181b5d9f972777de7a959a47403ffb5"></a><!-- doxytag: member="VirtualFile.h::VirtualFileRegisterSource" ref="ga0181b5d9f972777de7a959a47403ffb5" args="(VIRTUAL_FILE_SOURCE *vfs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int VirtualFileRegisterSource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a> *&#160;</td>
          <td class="paramname"><em>vfs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adds a new file source to the virtual file system.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">vfs</td><td>Must be a pointer to a valid <a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a> interface containing all your functions for handling the file source. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns the identifier of your source or -1 if it has failed. You can then use this ID as a file type (parameter for VirtualFileOpen). </dd></dl>

</div>
</div>
<a class="anchor" id="ga6f7804ec2206cf7b3de11a951f82763c"></a><!-- doxytag: member="VirtualFile.h::oslFindFileInVirtualFilenameList" ref="ga6f7804ec2206cf7b3de11a951f82763c" args="(const char *fname, int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_o_s_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">OSL_VIRTUALFILENAME</a>* oslFindFileInVirtualFilenameList </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Call this function in your virtual file source OPEN handler, if it's a RAM based device and param2 == 0 (means null size, impossible). It will return a UL_VIRTUALFILENAME where you can get a pointer to the data and their size. Note that the return value can be NULL if the file has not been found or an error occured (e.g. fname is NULL). </p>

</div>
</div>
<a class="anchor" id="ga81e5e0ef4b85e053188625c88b32c5a1"></a><!-- doxytag: member="VirtualFile.h::oslReadEntireFileToMemory" ref="ga81e5e0ef4b85e053188625c88b32c5a1" args="(VIRTUAL_FILE *f, int *size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* oslReadEntireFileToMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Reads an entire file to memory and returns a pointer to the memory block. The block memory usage is stepped by 4 kB, so even a 1 kB file will take 16 kB, so this function is not recommended for opening a lot of small files. The bloc must be freed (using free) once you've finished with it! </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Pointer to an open virtual file. </td></tr>
    <tr><td class="paramname">size</td><td>Pointer to an integer that will contain the number of bytes read from the file. Can be NULL (in this case the value is discarded).</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><pre class="fragment"><span class="keywordtype">int</span> size;
<a class="code" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *f;
<span class="keywordtype">char</span> *data;
<span class="comment">//Open a file</span>
f = <a class="code" href="group__virtualfile.html#ga07077224dae9a3b273e364c1167f7908">VirtualFileOpen</a>(<span class="stringliteral">&quot;test.txt&quot;</span>, 0, <a class="code" href="group__virtualfile__sources.html#ga1520dc89d51af85e1bd24e5377eff162">VF_AUTO</a>, <a class="code" href="group__virtualfile.html#gga2e7ccec76b09ff3f2d925f60050b5fcba2e020641b63339f59df52a0c2d4d3a02" title="Read only.">VF_O_READ</a>);
<span class="comment">//Read it entirely to RAM</span>
data = <a class="code" href="group__virtualfile.html#ga81e5e0ef4b85e053188625c88b32c5a1">oslReadEntireFileToMemory</a>(f, &amp;size);
<span class="comment">//Print each character</span>
<span class="keywordflow">for</span> (i=0;i&lt;size;i++)
        <a class="code" href="group__main__debug.html#ga88d2f4d23b2aa2f502329ee6e6b6e048">oslPrintf</a>(<span class="stringliteral">&quot;%c&quot;</span>, data[i]);
</pre></div> 
</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">Generated on Tue May 17 2011 10:54:48 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>

</body>
</html>
